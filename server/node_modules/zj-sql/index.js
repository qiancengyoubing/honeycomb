var mysql = require('mysql');
var connection = mysql.createConnection({
    host:'localhost',
    user:'root',
    password:'kyeepass',
    database:'analysis'
});
module.exports = {
    query:function(sql,matrix,successFn,errFn){
        connection.connect();
        if(matrix){
            connection.query(sql,matrix,function(err,res){
                if(err){
                    // throw error;
                    console.log('err =',err.sql);
                    console.log('err =',err.sqlMessage);
                    if(errFn){
                        errFn(err)
                    }
                    connection.end();
                }
                else{
                    if(successFn){
                        successFn(res)
                    }
                }
                connection.end();
            })
        }else{
            //这块需要处理下防止sql注入
            connection.query(sql,function(err,res){
                if(err){
                    // throw error;
                    console.log('err =',err.sql);
                    console.log('err =',err.sqlMessage);
                    if(errFn){
                        errFn(err)
                    }
                    connection.end();
                }
                else{
                    if(successFn){
                        successFn(res)
                    }
                }
                connection.end();
            })
        }
    }
};